(function($){$(document).ready(function(){function formatDate(dateString){const date=new Date(dateString);const month=date.getMonth()+1;const day=date.getDate();const year=date.getFullYear();return`${month}/${day}/${year}`;}
let listDayEvent=[];listDayEvent=JSON.parse($("#list_days").val());let selectedDate=null;let initialLoad=true;let calendar=document.querySelector(".calendar");const inputDate=document.querySelector(".input--date");if(calendar){let month_names=[];if(fulbright.lang==="vi"){month_names=["Tháng 1","Tháng 2","Tháng 3","Tháng 4","Tháng 5","Tháng 6","Tháng 7","Tháng 8","Tháng 9","Tháng 10","Tháng 11","Tháng 12",];}else{month_names=["January","February","March","April","May","June","July","August","September","October","November","December",];}
isLeapYear=(year)=>{return((year%4===0&&year%100!==0&&year%400!==0)||(year%100===0&&year%400===0));};getFebDays=(year)=>{return isLeapYear(year)?29:28;};generateCalendar=(month,year)=>{let calendar_days=calendar.querySelector(".calendar__body-days");let calendar_header_year=calendar.querySelector(".calendar__header-right--year");let days_of_month=[31,getFebDays(year),31,30,31,30,31,31,30,31,30,31,];calendar_days.innerHTML="";let currDate=new Date();if(month>12||month<0){month=currDate.getMonth();}
if(!year)year=currDate.getFullYear();let curr_month={value:month};let curr_year={value:year};let curr_month_name=`${month_names[curr_month.value]}`;month_picker.innerHTML=curr_month_name;calendar_header_year.innerHTML=curr_year.value;let first_day=new Date(curr_year.value,curr_month.value,1);let start_day=(first_day.getDay()-1+7)%7;let days_in_month=days_of_month[curr_month.value];let total_cells=Math.ceil((days_in_month+start_day)/7)*7;for(let i=0;i<total_cells;i++){let day=document.createElement("div");let spanDay=document.createElement("span");let cell_date;let title_date;if(i<start_day){let days_in_prev_month=new Date(curr_year.value,curr_month.value,0).getDate();cell_date=days_in_prev_month-(start_day-i-1);title_date=new Date(curr_year.value,curr_month.value-1,cell_date);day.classList.add("calendar__body-day");day.classList.add("calendar__body-day--past");day.classList.add("calendar__body-day--prev-month");day.addEventListener("click",()=>{curr_month.value=(curr_month.value-1+12)%12;curr_year.value=curr_month.value===11?curr_year.value-1:curr_year.value;generateCalendar(curr_month.value,curr_year.value);});}else if(i<start_day+days_in_month){cell_date=i-start_day+1;title_date=new Date(curr_year.value,curr_month.value,cell_date);day.classList.add("calendar__body-day");let convertDate=cell_date;let convertMDY=`${curr_month.value + 1}/${convertDate}/${
              curr_year.value
            }`;day.setAttribute("title",convertMDY);day.setAttribute("day",convertMDY);spanDay.innerHTML=convertDate;day.append(spanDay);let convertMDYDate=new Date(convertMDY);let currentDate=new Date();let yesterdayDate=new Date(currentDate.setDate(currentDate.getDate()-1));day.addEventListener("click",()=>{calendar_days.querySelectorAll(".calendar__body-day").forEach((item)=>{item.classList.remove("calendar__body-day--current");});day.classList.add("calendar__body-day--current");inputDate.value=day.getAttribute("title");});}else{cell_date=i-(start_day+days_in_month)+1;title_date=new Date(curr_year.value,curr_month.value+1,cell_date);day.classList.add("calendar__body-day");day.classList.add("calendar__body-day--past");day.classList.add("calendar__body-day--next-month");day.addEventListener("click",()=>{curr_month.value=(curr_month.value+1)%12;curr_year.value=curr_month.value===0?curr_year.value+1:curr_year.value;generateCalendar(curr_month.value,curr_year.value);});}
day.setAttribute("title",formatDate(title_date));day.setAttribute("day",formatDate(title_date));spanDay.innerHTML=cell_date;day.append(spanDay);calendar_days.appendChild(day);if(initialLoad){if(i-first_day.getDay()+1===currDate.getDate()&&year===currDate.getFullYear()&&month===currDate.getMonth()){day.classList.add("calendar__body-day--current");inputDate.value=day.getAttribute("title");selectedDate=day.getAttribute("title");}}
initialLoad=false;if(selectedDate&&selectedDate===day.getAttribute("title")){day.classList.add("calendar__body-day--current");}}
current_month.value=month;};let current_month={value:0};$("body").bind("DOMSubtreeModified",function(e){$(".calendar__body-day").each(function(index){if(listDayEvent.includes($(this).attr("day"))){$(this).addClass("active");}});const calendarDays=document.querySelectorAll(".calendar__body-day");const inputDate=document.querySelector(".input--date");calendarDays.forEach((item)=>{item.addEventListener("click",function(){calendarDays.forEach((item1)=>{item1.classList.remove("calendar__body-day--current");});item.classList.add("calendar__body-day--current");inputDate.value=item.getAttribute("title");selectedDate=item.getAttribute("title");$(".calendar__body-day").each(function(index){$(this).removeClass("calendar__body-day--current");if($(this).attr("title")===$(".input--date").val()){$(this).addClass("calendar__body-day--current");}});});});});let month_picker=calendar.querySelector(".calendar__header-right--month");let currDate=new Date();current_month.value=currDate.getMonth();let curr_year={value:currDate.getFullYear()};generateCalendar(current_month.value,curr_year.value);document.querySelector("#prev-year").onclick=()=>{current_month.value=current_month.value-1;if(current_month.value<0){curr_year.value=curr_year.value-1;current_month.value=11;}
generateCalendar(current_month.value,curr_year.value);};document.querySelector("#next-year").onclick=()=>{current_month.value=current_month.value+1;if(current_month.value>11){curr_year.value=curr_year.value+1;current_month.value=0;}
generateCalendar(current_month.value,curr_year.value);};}
function setFeatured(){if(window.innerWidth>578){let heightOfFeatured=Math.ceil($(".featured__item").length/2)*36-34;let heightFirst=heightOfFeatured;let heightSecond=heightOfFeatured;$.each($(".featured__item"),function(index,value){if(Math.ceil($(".featured__item").length/2)>index){heightFirst+=$(value).outerHeight();}else{heightSecond+=$(value).outerHeight();}});if(heightFirst>=heightSecond){heightOfFeatured=heightFirst;}else{heightOfFeatured=heightSecond;}
$(".featured__list").height(heightOfFeatured);}}
var featuredItems=document.querySelectorAll(".featured__item");var oddItems=[];var evenItems=[];featuredItems.forEach(function(item,index){if(index%2===0){evenItems.push(item);}else{oddItems.push(item);}});var featuredList=document.querySelector(".featured__list");if(featuredList){featuredList.innerHTML="";}
evenItems.forEach(function(item){featuredList.appendChild(item);});oddItems.forEach(function(item){featuredList.appendChild(item);});const checkChecked=()=>{if($('.sidebar .list-checkbox input[type="checkbox"]:checked').length>0){$('.sidebar .btn-submit input[type="submit"]').prop("disabled",false);}else{$('.sidebar .btn-submit input[type="submit"]').prop("disabled",true);}};checkChecked();$('.sidebar .list-checkbox input[type="checkbox"]').change(function(){checkChecked();});$(".sidebar form .form-wrap").scroll(function(){const bottomScroll=$(this).position().top+$(this).outerHeight();const topButtons=$(".sidebar .sidebar__buttons").position().top;if(topButtons<=bottomScroll){$(".sidebar .btn-submit").addClass("active");}else{$(".sidebar .btn-submit").removeClass("active");}});function checkCheckboxStatus(){const allCategoriesChecked=$("input:checkbox[name=single_major]").length===$("input:checkbox[name=single_major]:checked").length;$("#all-majors").prop("checked",allCategoriesChecked);}
$("#events_loading").on("click",".button-pagi",function(e){const time=$(this).data("time");const earliest_date=$(".events__pagi").data("earliest_date");const latest_date=$(".events__pagi").data("latest_date");$.ajax({url:fulbright.site_url+"/wp-admin/admin-ajax.php",dataType:"html",type:"get",data:{action:"events_loading",time:time,earliest_date:earliest_date,latest_date:latest_date,},success:function(str){$("#events_loading").html(str);},});});$(document).on("click",".content__container .j_btn-explore",function(e){e.preventDefault();$("#events_pick_day").addClass("d-none");$("#default_display").removeClass("d-none");$("#commencement").removeClass("d-none");});$(document).on("click",".calendar__body-day",function(){$("#default_display").addClass("d-none");$("#commencement").addClass("d-none");$("#events_pick_day").removeClass("d-none");const time=$(this).attr("title");$.ajax({url:fulbright.site_url+"/wp-admin/admin-ajax.php",dataType:"html",type:"get",data:{action:"events_pick_day",time:time,},success:function(str){$("#events_pick_day").html(str);},});});$("#all-majors").change(function(){if($(this).is(":checked")){$("input:checkbox[class=input_all_major]").prop("checked",true);}else{$("input:checkbox[class=input_all_major]").prop("checked",false);}});$(".btn-clear-all").click(function(e){e.preventDefault();$("input:checkbox[class=input_all_major]").prop("checked",false).change();});$("input[type=submit]").click(function(e){e.preventDefault();$(".sidebar").removeClass("active");});function eventFilter(){checkCheckboxStatus();const time=$(".events__pagi").data("time");const earliest_date=$(".events__pagi").data("earliest_date");const latest_date=$(".events__pagi").data("latest_date");const list_categories=$("input:checkbox[class=input_all_major]:checked").map(function(){return $(this).val();}).get();$.ajax({url:fulbright.site_url+"/wp-admin/admin-ajax.php",dataType:"html",type:"get",data:{action:"events_loading",time:time,earliest_date:earliest_date,latest_date:latest_date,list_categories:list_categories,},success:function(str){$("#events_loading").html(str);},});}
if($('.btn-submit').is(':visible')){$(".list-checkbox").off("change");}
else{$(".list-checkbox").on("change",eventFilter);}
$('.btn-submit').click(eventFilter);});})(jQuery);